<div class="character-details-container">
  <div class="container character-details-wrapper">
    <div class="row">
      <div class="col-12">
        <nav aria-label="breadcrumb" class="breadcrumb-nav">
          <ol class="breadcrumb">
            <li class="breadcrumb-item">
              <a routerLink="/characters" class="text-decoration-none">Characters</a>
            </li>
            <li class="breadcrumb-item active" aria-current="page">
              @if (character) {
                {{ character.name }}
              } @else {
                Character Details
              }
            </li>
          </ol>
        </nav>
      </div>
    </div>

    @if (character) {
      <div class="details-grid">
        <div class="image-section">
          <div class="card character-image-card shadow-sm">
            <div class="position-relative">
              <img
                [src]="character.image"
                class="card-img-top character-image"
                [alt]="character.name"
              />
            </div>
          </div>
        </div>

        <div class="info-section">
          <div class="card character-info-card shadow-sm">
            <div class="card-header bg-white">
              <h1 class="card-title">{{ character.name }}</h1>
            </div>
            <div class="card-body">
              <section class="info-section">
                <h2 class="section-title">Basic Information</h2>
                <div class="info-grid">
                  <div class="info-item">
                    <span class="info-label">Gender:</span>
                    <span class="info-value">{{ character.gender }}</span>
                  </div>
                  <div class="info-item">
                    <span class="info-label">Species:</span>
                    <span class="info-value">{{ character.species }}</span>
                  </div>
                  <div class="info-item spoiler-container">
                    <span class="info-label"
                      >Status:
                      <button class="spoiler-toggle-btn" (click)="toggleStatusSpoiler()">
                        {{ isStatusRevealed ? 'Hide' : 'Reveal Spoiler' }}
                      </button>
                    </span>
                    <span class="info-value">
                      @if (isStatusRevealed) {
                        <span class="status-{{ character.status?.toLowerCase() }}">
                          {{
                            character.status
                              ? character.status.charAt(0).toUpperCase() + character.status.slice(1)
                              : 'Unknown'
                          }}
                        </span>
                      } @else {
                        <span class="spoiler-hidden">???</span>
                      }
                    </span>
                  </div>
                </div>
              </section>

              <section class="info-section featured-section">
                <h2 class="section-title">Appearances</h2>
                <div class="section-content">
                  @if (character.episode && character.episode.length > 0) {
                    <div class="info-item">
                      @for (
                        seasonData of getSeasonEpisodes();
                        track seasonData.season;
                        let first = $first
                      ) {
                        <div class="season-entry">
                          <span class="season-label">Season {{ seasonData.season }}:</span>
                          <span class="episode-list">
                            @if (seasonData.episodes.length === 1) {
                              Episode {{ formatEpisodeList(seasonData.episodes) }}
                            } @else {
                              Episodes {{ formatEpisodeList(seasonData.episodes) }}
                            }
                          </span>
                        </div>
                      }
                    </div>
                  } @else {
                    <p>No episode information available.</p>
                  }
                </div>
              </section>

              <section class="info-section featured-section">
                <h2 class="section-title">Biography</h2>
                <div class="section-content">
                  <p>
                    Detailed biography information would appear here. Alas, its not provided by the
                    API. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus vitae
                    fringilla turpis. Donec sit amet molestie urna, sed placerat massa. Nam et
                    dignissim sem, ac ultricies tellus. Maecenas eu felis sit amet quam commodo
                    fermentum vel vel sapien. Etiam ut nisi porttitor, consectetur enim non,
                    accumsan justo.
                  </p>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>
    } @else {
      <div class="loading-section">
        <div class="card">
          <div class="card-body text-center">
            <div class="spinner-border text-primary" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p>Loading character details...</p>
            <a routerLink="/characters" class="btn btn-outline-primary"> ‚Üê Back to Characters </a>
          </div>
        </div>
      </div>
    }
  </div>
</div>
