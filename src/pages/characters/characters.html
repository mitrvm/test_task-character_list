<div class="container-fluid py-4">
  <div class="row">
    <div class="col-12">
      <div class="d-flex justify-content-end gap-2 mb-2">
        <!-- Поиск -->
        <div class="search-container">
          <input
            type="text"
            class="form-control form-control-sm"
            placeholder="Search by name..."
            [ngModel]="searchTerm()"
            (ngModelChange)="searchTerm.set($event); onSearch()"
          />
        </div>
        <!-- Фильтр -->
        <div class="filter-container">
          <select
            class="form-select form-select-sm"
            [ngModel]="genderFilter()"
            (ngModelChange)="genderFilter.set($event); onGenderFilterChange()"
          >
            <option value="all">All Genders</option>
            <option value="male">Male</option>
            <option value="female">Female</option>
            <option value="unknown">Unknown</option>
          </select>
        </div>
      </div>

      @if (error() && !isLoading()) {
        <app-error-section [message]="error()!" (retry)="loadCharacters()" />
      }

      @if (characters().length > 0 && !error()) {
        <div class="card border-0 shadow-sm">
          <div class="card-body p-0">
            <table class="table table-hover">
              <thead class="table-dark">
                <tr>
                  <th scope="col" class="text-center">Avatar</th>
                  <th scope="col" class="sortable-header" (click)="toggleSort()">
                    Name
                    <span class="sort-indicators">
                      <span class="sort-arrow" [class.active]="sortDirection() === 'asc'">▲</span>
                      <span class="sort-arrow" [class.active]="sortDirection() === 'desc'">▼</span>
                    </span>
                  </th>
                  <th scope="col">Gender</th>
                </tr>
              </thead>
              <tbody>
                @for (
                  character of sortedAndFilteredCharacters();
                  track character.id + '_' + $index
                ) {
                  <tr (click)="goToCharacterDetails(character.id)" class="character-row">
                    <td>
                      <img
                        [src]="character.image"
                        [alt]="character.name"
                        class="rounded-circle"
                        width="50"
                        height="50"
                      />
                    </td>
                    <td class="fw-medium">{{ character.name }}</td>
                    <td>
                      <app-icon
                        [name]="getGenderIcon(character.gender)"
                        [size]="24"
                        [alt]="character.gender"
                        class="gender-icon"
                      ></app-icon>
                    </td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </div>
      }

      @if (isLoading()) {
        <app-loading-section />
      }
    </div>
  </div>

  <router-outlet />
</div>
